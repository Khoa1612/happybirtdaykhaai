<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ch√∫c M·ª´ng Sinh Nh·∫≠t Kh·∫£ √Åi :></title>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Comic Neue', cursive;
        }

        body {
            overflow-x: hidden;
            background: #fff0f5;
            color: #333;
            transition: all 0.5s ease;
        }

        /* Lock Screen */
        .lock-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('anh7.png') center/cover no-repeat; /* ·∫¢nh n·ªÅn m√†n h√¨nh kh√≥a */
            background-size: cover; /* ƒê·∫£m b·∫£o ·∫£nh ph·ªß k√≠n */
            backdrop-filter: blur(20px) brightness(0.8); /* TƒÉng ƒë·ªô m·ªù v√† gi·∫£m ƒë·ªô s√°ng m·ªôt ch√∫t */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 1s ease;
            color: #fff; /* Ch·ªØ m√†u tr·∫Øng ƒë·ªÉ n·ªïi b·∫≠t tr√™n n·ªÅn t·ªëi */
            text-align: center; /* CƒÉn gi·ªØa n·ªôi dung */
        }

        .time {
            font-size: 5rem; /* Ch·ªØ l·ªõn h∆°n */
            font-weight: bold; /* Ch·ªØ ƒë·∫≠m h∆°n */
            color: #fff; /* M√†u tr·∫Øng */
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.8); /* B√≥ng ƒë·ªï ƒë·∫≠m h∆°n */
            margin-bottom: 10px;
        }

        .date {
            font-size: 1.8rem; /* Ch·ªØ l·ªõn h∆°n */
            color: #eee; /* M√†u tr·∫Øng nh·∫°t h∆°n m·ªôt ch√∫t */
            text-shadow: 1px 1px 5px rgba(0, 0, 0, 0.7); /* B√≥ng ƒë·ªï nh·∫π h∆°n */
            margin-bottom: 40px;
        }

        .passcode-container {
            background: rgba(0, 0, 0, 0.5); /* N·ªÅn ƒëen m·ªù h∆°n */
            padding: 25px; /* Padding l·ªõn h∆°n */
            border-radius: 15px; /* Bo tr√≤n √≠t h∆°n */
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5); /* Th√™m b√≥ng ƒë·ªï cho container */
        }

        .passcode-error {
            color: #ffdddd; /* M√†u ƒë·ªè nh·∫°t h∆°n */
            font-size: 1.1rem; /* Ch·ªØ l·ªõn h∆°n m·ªôt ch√∫t */
            margin-bottom: 20px;
            display: none;
            animation: shake 0.5s ease;
        }

        .passcode-input {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .passcode-dot {
            width: 20px; /* L·ªõn h∆°n */
            height: 20px; /* L·ªõn h∆°n */
            border-radius: 50%;
            border: 3px solid #fff; /* Vi·ªÅn tr·∫Øng ƒë·∫≠m h∆°n */
            margin: 0 10px; /* Kho·∫£ng c√°ch l·ªõn h∆°n */
            transition: background-color 0.3s ease;
        }

        .passcode-dot.filled {
            background-color: #fff; /* Ch·∫•m tr√≤n m√†u tr·∫Øng khi nh·∫≠p */
        }

        .passcode-keypad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .passcode-key {
            width: 70px; /* L·ªõn h∆°n */
            height: 70px; /* L·ªõn h∆°n */
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1); /* N·ªÅn tr·∫Øng m·ªù h∆°n */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem; /* Ch·ªØ s·ªë l·ªõn h∆°n */
            color: #fff; /* M√†u tr·∫Øng */
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .passcode-key:hover {
            background: rgba(255, 255, 255, 0.2); /* Hi·ªáu ·ª©ng hover ƒë·∫≠m h∆°n */
        }

        .passcode-key:active {
            transform: scale(0.95);
        }

        .passcode-key.empty {
            visibility: hidden;
        }

        .passcode-key.delete {
            font-size: 1.8rem; /* Bi·ªÉu t∆∞·ª£ng x√≥a nh·ªè h∆°n m·ªôt ch√∫t */
        }

        /* Birthday Container */
        .birthday-container {
            display: none; /* Changed from flex to none, then flex on unlock */
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            /* N·ªÅn gradient ƒë·ªông */
            background: linear-gradient(135deg, #ffe4e1, #ffccde, #ffb6c1, #ff99cc);
            background-size: 200% 200%; /* K√≠ch th∆∞·ªõc l·ªõn h∆°n ƒë·ªÉ c√≥ th·ªÉ di chuy·ªÉn */
            animation: gradientMove 15s ease infinite alternate; /* Ho·∫°t h√¨nh di chuy·ªÉn gradient */
            position: relative;
            overflow: hidden; /* Quan tr·ªçng ƒë·ªÉ c√°c animation kh√¥ng tr√†n ra ngo√†i */
        }

        @keyframes gradientMove {
            0% { background-position: 0% 0%; }
            100% { background-position: 100% 100%; }
        }

        /* Balloon Animation */
        .balloon {
            position: absolute;
            width: 70px; /* To h∆°n m·ªôt ch√∫t */
            height: 90px;
            background: radial-gradient(circle at 30%, var(--balloon-color1, #ff6b6b), var(--balloon-color2, #ff99cc));
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            bottom: -100px;
            cursor: pointer;
            /* Animation ph·ª©c t·∫°p h∆°n */
            animation: floatBalloon 10s infinite ease-in-out;
            opacity: 0.9;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .balloon::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 20px;
            background: #333;
        }

        @keyframes floatBalloon {
            0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.8; }
            25% { transform: translateY(-50px) translateX(20px) rotate(5deg); opacity: 0.9; }
            50% { transform: translateY(-100px) translateX(-20px) rotate(-5deg); opacity: 1; }
            75% { transform: translateY(-50px) translateX(10px) rotate(3deg); opacity: 0.9; }
            100% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.8; }
        }

        .heart-particle {
            position: absolute;
            font-size: 20px;
            color: #ff4757;
            animation: heartPop 1s ease-out forwards;
        }

        @keyframes heartPop {
            0% { transform: translate(0, 0); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)); opacity: 0; }
        }

        /* Falling Star Animation */
        .falling-star {
            position: absolute;
            width: 5px;
            height: 5px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 5px white, 0 0 10px white, 0 0 15px white;
            animation: fallAndFade var(--duration) linear forwards;
            opacity: 0; /* B·∫Øt ƒë·∫ßu ·∫©n */
            z-index: 5; /* N·∫±m d∆∞·ªõi n·ªôi dung ch√≠nh */
        }

        @keyframes fallAndFade {
            0% { transform: translateY(-10vh) translateX(0); opacity: 0; }
            20% { opacity: 1; } /* Hi·ªán r√µ sau 20% */
            100% { transform: translateY(110vh) translateX(var(--travelX)); opacity: 0; }
        }

        /* Heart Rain Animation */
        .heart-rain {
            position: absolute;
            font-size: 1.5rem;
            color: #ff6b6b; /* M√†u h·ªìng */
            animation: heartFall var(--duration) linear forwards;
            opacity: 0;
            z-index: 5; /* N·∫±m d∆∞·ªõi n·ªôi dung ch√≠nh */
            text-shadow: 0 0 5px rgba(255,107,107,0.5);
        }

        @keyframes heartFall {
            0% { transform: translateY(-10vh); opacity: 0; }
            10% { opacity: 0.8; }
            100% { transform: translateY(110vh); opacity: 0; }
        }

        /* Sparkle Trail on Mouse Move */
        .sparkle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #fff;
            border-radius: 50%;
            box-shadow: 0 0 5px #fff, 0 0 10px #ffccde;
            animation: sparkleFadeOut 0.8s forwards;
            pointer-events: none; /* Kh√¥ng ch·∫∑n click */
            z-index: 99; /* Lu√¥n ·ªü tr√™n c√πng */
        }

        @keyframes sparkleFadeOut {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0.1); opacity: 0; }
        }

        /* Birthday Content */
        .birthday-content {
            text-align: center;
            z-index: 10;
            max-width: 1000px;
            margin: 20px auto;
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-size: 3rem;
            color: #ff4757;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            animation: bounceIn 1s ease-out;
        }

        /* TV Frame Styling */
        .tv-frame {
            position: relative;
            width: 90%;
            max-width: 600px; /* C√≥ th·ªÉ ƒëi·ªÅu ch·ªânh k√≠ch th∆∞·ªõc TV */
            margin: 40px auto;
            background-color: #333; /* M√†u th√¢n TV */
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.5), 0 0 0 10px rgba(0,0,0,0.1);
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 8px solid #222; /* Vi·ªÅn d√†y h∆°n cho c·∫£m gi√°c TV */
            transition: transform 0.3s ease;
        }

        .tv-frame:hover {
            transform: translateY(-5px); /* Hi·ªáu ·ª©ng nh·∫•c nh·∫π khi hover */
        }

        .tv-screen {
            position: relative;
            width: 100%;
            /* T·ª∑ l·ªá 16:9 */
            padding-top: 56.25%;
            background-color: #000;
            border: 5px solid #000; /* Vi·ªÅn m√†n h√¨nh */
            border-radius: 8px;
            overflow: hidden; /* Quan tr·ªçng ƒë·ªÉ ·∫£nh kh√¥ng tr√†n ra ngo√†i */
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.8);
            cursor: pointer;
            transition: background-color 0.5s ease-in-out; /* ƒê·ªÉ b·∫≠t/t·∫Øt m√†n h√¨nh */
        }

        .tv-screen.off {
            background-color: #222; /* M√†u khi TV t·∫Øt */
        }

        .tv-screen img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            /* Lo·∫°i b·ªè border, box-shadow t·ª´ .main-gallery-display img c≈© */
            border: none;
            box-shadow: none;
            transition: opacity 0.5s ease-in-out; /* Chuy·ªÉn ·∫£nh m∆∞·ª£t m√† */
        }

        .tv-screen.off img {
            opacity: 0 !important; /* ·∫®n ·∫£nh khi TV t·∫Øt */
        }


        .tv-static-effect {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 50% 50%, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.3) 100%);
            opacity: 0.2; /* ƒê·ªô m·ªù c·ªßa hi·ªáu ·ª©ng nhi·ªÖu */
            pointer-events: none; /* Kh√¥ng ch·∫∑n t∆∞∆°ng t√°c chu·ªôt */
            animation: tvStatic 0.1s infinite alternate; /* Ho·∫°t h√¨nh nhi·ªÖu nh·∫π */
            z-index: 2; /* N·∫±m tr√™n ·∫£nh */
        }

        .tv-screen.off .tv-static-effect {
            opacity: 0.5; /* Nhi·ªÖu r√µ h∆°n khi t·∫Øt */
        }


        @keyframes tvStatic {
            0% { transform: scale(1, 1); opacity: 0.1; }
            100% { transform: scale(1.01, 1.01); opacity: 0.2; }
        }

        .tv-scanlines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
            background-size: 100% 2px; /* Chi·ªÅu cao c·ªßa m·ªói v·∫°ch qu√©t */
            opacity: 0.3; /* ƒê·ªô m·ªù c·ªßa v·∫°ch qu√©t */
            pointer-events: none;
            animation: scanlines 5s linear infinite;
            z-index: 3; /* N·∫±m tr√™n hi·ªáu ·ª©ng nhi·ªÖu */
        }

        .tv-screen.off .tv-scanlines {
            opacity: 0.7; /* V·∫°ch qu√©t r√µ h∆°n khi t·∫Øt */
        }

        @keyframes scanlines {
            to { background-position: 0 100%; }
        }

        .main-gallery-nav {
            position: absolute; /* Gi·ªØ nguy√™n v·ªã tr√≠ n√∫t */
            top: 50%;
            transform: translateY(-50%);
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 10px;
            z-index: 10; /* ƒê·∫£m b·∫£o n√∫t ·ªü tr√™n hi·ªáu ·ª©ng TV */
        }

        .tv-screen.off .main-gallery-nav {
            visibility: hidden; /* ·∫®n n√∫t ƒëi·ªÅu h∆∞·ªõng khi TV t·∫Øt */
        }

        /* TV Stand */
        .tv-stand {
            width: 60%;
            height: 15px;
            background-color: #444;
            border-radius: 0 0 10px 10px;
            margin-top: 15px;
            box-shadow: inset 0 3px 5px rgba(0,0,0,0.3);
        }

        /* TV Button Panel */
        .tv-button-panel {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            padding: 5px 15px;
            background-color: #444;
            border-radius: 5px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.3);
        }

        .tv-button {
            width: 15px;
            height: 15px;
            background-color: #666;
            border-radius: 50%;
            border: 1px solid #333;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.5);
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .tv-button:hover {
            background-color: #888;
        }

        .tv-power-button {
            background-color: #d9534f; /* M√†u ƒë·ªè n·ªïi b·∫≠t cho n√∫t ngu·ªìn */
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.5), 0 0 5px rgba(217, 83, 79, 0.7); /* Th√™m hi·ªáu ·ª©ng ph√°t s√°ng */
            width: 20px; /* L·ªõn h∆°n */
            height: 20px; /* L·ªõn h∆°n */
            position: relative;
            cursor: pointer;
        }

        .tv-power-button::before {
            content: '‚èª'; /* Bi·ªÉu t∆∞·ª£ng ngu·ªìn */
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.2rem;
            color: #fff;
        }

        .tv-power-button:hover {
            background-color: #c9302c;
        }

        .tv-speaker {
            width: 40px;
            height: 30px;
            background-color: #555;
            border-radius: 5px;
            position: relative;
            overflow: hidden;
            margin-left: 15px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.5);
        }

        .tv-speaker::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #333 1px, transparent 1px);
            background-size: 100% 5px; /* C√°c v·∫°ch loa */
        }

        /* Fullscreen Slideshow */
        .gallery-slider {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .gallery-slider.active {
            display: flex;
        }

        .slider-container {
            width: 90%;
            max-width: 800px;
            height: 70vh;
            position: relative;
            display: flex; /* D√πng flexbox ƒë·ªÉ cƒÉn gi·ªØa ·∫£nh */
            align-items: center; /* CƒÉn gi·ªØa theo chi·ªÅu d·ªçc */
            justify-content: center; /* CƒÉn gi·ªØa theo chi·ªÅu ngang */
        }

        .slider-image {
            width: 100%;
            height: 100%;
            object-fit: contain; /* ƒê·∫£m b·∫£o ·∫£nh v·ª´a khung m√† kh√¥ng b·ªã c·∫Øt ho·∫∑c m√©o */
            opacity: 0;
            position: absolute; /* Gi·ªØ nguy√™n position absolute */
            transition: opacity 0.8s ease-in-out; /* Smoother transition */
            cursor: pointer;
            border-radius: 10px; /* Th√™m bo tr√≤n nh·∫π */
            box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3); /* Th√™m b√≥ng ƒë·ªï nh·∫π */
            border: 5px solid rgba(255, 255, 255, 0.7); /* Th√™m vi·ªÅn tr·∫Øng m·ªèng */
            left: 0; /* ƒê·∫£m b·∫£o kh√¥ng b·ªã l·ªách */
            top: 0; /* ƒê·∫£m b·∫£o kh√¥ng b·ªã l·ªách */
            transform: none; /* Reset m·ªçi transform c√≥ th·ªÉ g√¢y l·ªách */
        }

        .slider-image.active {
            opacity: 1;
        }

        .thumbnail-nav {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            overflow-x: auto;
            padding: 10px;
            justify-content: center; /* Center thumbnails */
            max-width: 80%; /* Limit thumbnail row width */
        }

        .thumbnail {
            flex-shrink: 0; /* Prevent shrinking */
            width: 80px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px; /* Th√™m bo tr√≤n nh·∫π */
            box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.2); /* Th√™m b√≥ng ƒë·ªï nh·∫π */
            border: 3px solid rgba(255, 255, 255, 0.7); /* Th√™m vi·ªÅn tr·∫Øng m·ªèng */
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.3s ease, transform 0.3s ease, border-color 0.3s ease;
        }

        .thumbnail.active {
            opacity: 1;
            transform: scale(1.1);
            border-color: #ff6b6b; /* Highlight active thumbnail */
        }

        .thumbnail:hover {
            opacity: 0.9;
        }

        .close-gallery, .slider-prev-btn, .slider-next-btn { /* Renamed for clarity */
            color: #fff;
            cursor: pointer;
            font-size: 2rem;
            z-index: 1001;
            background: rgba(255, 182, 193, 0.5);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }

        .close-gallery:hover, .slider-prev-btn:hover, .slider-next-btn:hover {
            background: #ff6b6b;
        }

        .close-gallery {
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .slider-prev-btn {
            position: absolute;
            top: 50%;
            left: 20px;
            transform: translateY(-50%);
        }

        .slider-next-btn {
            position: absolute;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
        }

        /* Birthday Card */
        .card-trigger {
            margin: 40px auto; /* TƒÉng margin */
            cursor: pointer;
            width: 380px; /* TƒÉng k√≠ch th∆∞·ªõc thi·ªáp */
            height: 270px; /* TƒÉng k√≠ch th∆∞·ªõc thi·ªáp */
            position: relative;
        }

        .card-envelope {
            width: 100%;
            height: 100%;
            background: linear-gradient(160deg, #ff6b6b 0%, #ff99cc 100%); /* Gradient ch√©o */
            border-radius: 15px; /* Bo tr√≤n h∆°n */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4); /* B√≥ng ƒë·ªï r√µ h∆°n */
            position: relative;
            overflow: hidden;
            border: 4px solid #ffd700; /* Vi·ªÅn v√†ng ƒë·∫≠m h∆°n */
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out; /* Th√™m transition cho box-shadow */
        }

        .card-envelope::before {
            content: '';
            position: absolute;
            top: -10px; /* ƒêi·ªÅu ch·ªânh v·ªã tr√≠ */
            left: 50%;
            transform: translateX(-50%);
            width: 70%; /* R·ªông h∆°n */
            height: 40px; /* Cao h∆°n */
            background: linear-gradient(to top, #ffd700, transparent); /* T·∫°o h√¨nh n·∫Øp th∆∞ */
            border-radius: 10px 10px 0 0;
            z-index: 1;
        }

        .card-envelope::after { /* Hi·ªáu ·ª©ng l∆∞·ª£n s√≥ng */
            content: '';
            position: absolute;
            bottom: -5px; /* ƒêi·ªÅu ch·ªânh v·ªã tr√≠ */
            left: 0;
            width: 100%;
            height: 25px; /* Cao h∆°n */
            background: repeating-linear-gradient(
                -45deg,
                #ffccde,
                #ffccde 5px,
                #ffb6c1 5px,
                #ffb6c1 10px
            );
            /* S·ª≠ d·ª•ng repeating-linear-gradient cho hi·ªáu ·ª©ng s·ªçc */
            transform: translateY(10px);
            opacity: 0.9;
        }

        .card-trigger:hover .card-envelope {
            transform: scale(1.05); /* Ph√≥ng to nh·∫π khi hover */
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.5); /* B√≥ng ƒë·ªï r√µ h∆°n */
        }

        .card-ribbon {
            position: absolute;
            top: 20%; /* ƒêi·ªÅu ch·ªânh v·ªã tr√≠ ribbon */
            left: 0;
            width: 100%;
            height: 35px; /* Cao h∆°n */
            background: #ffd700;
            opacity: 0.9;
            z-index: 2; /* ƒê·∫£m b·∫£o ribbon n·∫±m tr√™n c√°c hi·ªáu ·ª©ng kh√°c */
        }

        .card-instruction {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.2rem; /* L·ªõn h∆°n */
            color: #fff;
            background-color: rgba(0, 0, 0, 0.6); /* ƒê·∫≠m h∆°n */
            padding: 8px 15px; /* Padding l·ªõn h∆°n */
            border-radius: 8px; /* Bo tr√≤n h∆°n */
            animation: pulse 1.5s infinite; /* Hi·ªáu ·ª©ng nh·∫•p nh√°y */
            z-index: 3; /* ƒê·∫£m b·∫£o n·∫±m tr√™n ribbon */
            pointer-events: none; /* Kh√¥ng ch·∫∑n click v√†o thi·ªáp */
        }

        @keyframes pulse {
            0% { opacity: 0.9; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.03); }
            100% { opacity: 0.9; transform: translate(-50%, -50%) scale(1); }
        }

        .card-container {
            display: none; /* Changed from flex to none */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .card-container.active {
            display: flex;
        }

        .card-quiz {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            display: none; /* Hidden by default */
        }

        .card-quiz h2 {
            font-size: 1.8rem;
            color: #ff4757;
            margin-bottom: 20px;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            padding: 10px;
            border: 2px solid #ff99cc;
            border-radius: 10px;
            background: rgba(255, 182, 193, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            background: #ff6b6b;
            color: #fff;
        }

        .quiz-feedback {
            margin-top: 15px;
            font-size: 1rem;
            color: #ff4757;
            display: none;
        }

        .quiz-feedback.show {
            display: block;
        }

        /* Card Animation (simplified for letter style) */
        .card-animation {
            position: relative;
            width: 500px; /* R·ªông h∆°n ƒë·ªÉ gi·ªëng l√° th∆∞ */
            height: 600px; /* Cao h∆°n ƒë·ªÉ gi·ªëng l√° th∆∞ */
            background: #fff; /* N·ªÅn tr·∫Øng c·ªßa l√° th∆∞ */
            border: 5px solid #ff99cc; /* Vi·ªÅn d√†y v√† ƒë·∫πp */
            border-radius: 15px; /* Bo tr√≤n g√≥c */
            overflow: hidden;
            display: none; /* Hidden by default */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); /* B√≥ng ƒë·ªï cho thi·ªáp */
            transition: all 0.5s ease;
        }

        .card-animation.active {
            display: flex; /* Thay v√¨ block */
            align-items: center;
            justify-content: center;
        }

        .card-paper {
            position: relative; /* Kh√¥ng c√≤n absolute n·ªØa */
            width: 90%; /* Chi·∫øm ph·∫ßn l·ªõn di·ªán t√≠ch */
            height: 90%;
            background: #fff;
            border: 2px dashed #ff99cc;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            text-align: center;
            font-size: 1.2rem; /* Ch·ªØ to h∆°n */
            color: #ff4757;
            padding: 30px; /* Padding l·ªõn h∆°n */
            transform: scale(0); /* Ban ƒë·∫ßu ·∫©n */
            opacity: 0;
            transition: transform 0.5s ease, opacity 0.5s ease;
        }

        .card-paper.revealed {
            transform: scale(1);
            opacity: 1;
        }

        .happy-birthday {
            font-size: 2.5rem; /* L·ªõn h∆°n n·ªØa */
            color: #ff4757;
            animation: bounceIn 1s ease;
            margin-bottom: 20px; /* Kho·∫£ng c√°ch l·ªõn h∆°n */
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
        }

        .card-message {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001;
            /* ƒê·∫£m b·∫£o ·∫©n khi kh√¥ng active */
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .card-message.active {
            opacity: 1;
            pointer-events: auto;
        }


        .card-message-content {
            background: #fff;
            padding: 40px; /* TƒÉng padding ƒë·ªÉ n·ªôi dung l·ªõn h∆°n */
            border: 2px dashed #ff99cc;
            border-radius: 20px;
            max-width: 800px; /* TƒÉng k√≠ch th∆∞·ªõc t·ªëi ƒëa */
            width: 95%; /* Chi·∫øm 95% chi·ªÅu r·ªông m√†n h√¨nh */
            text-align: center;
            transform: scale(0);
            transition: transform 0.5s ease, opacity 0.5s ease;
            opacity: 0;
            position: relative; /* For confetti positioning */
        }

        .card-message-content.open {
            transform: scale(1);
            opacity: 1;
        }

        .card-message-content h2 {
            font-size: 2.8rem; /* Ti√™u ƒë·ªÅ l·ªõn h∆°n */
            color: #ff4757;
            margin-bottom: 30px; /* Kho·∫£ng c√°ch l·ªõn h∆°n */
        }

        .card-message-content p {
            font-size: 1.6rem; /* N·ªôi dung l·ªõn h∆°n */
            color: #333;
            line-height: 1.8; /* Kho·∫£ng c√°ch d√≤ng l·ªõn h∆°n */
            margin-bottom: 15px; /* Kho·∫£ng c√°ch gi·ªØa c√°c ƒëo·∫°n */
        }

        .card-message-content .signature {
            font-style: italic;
            font-size: 1.4rem; /* Ch·ªØ k√Ω l·ªõn h∆°n */
            margin-top: 40px; /* Kho·∫£ng c√°ch l·ªõn h∆°n */
            text-align: right;
            color: #555;
            font-weight: bold;
        }

        .close-message {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem; /* N√∫t ƒë√≥ng l·ªõn h∆°n */
            color: #ff4757;
            cursor: pointer;
            background: rgba(255,255,255,0.7);
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s ease;
        }

        .close-message:hover {
            background: #ffcccc;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ffd700; /* Default, will be overridden by JS */
            border-radius: 50%;
            animation: confettiFall 2s ease-out forwards;
        }

        @keyframes confettiFall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100px) rotate(360deg); opacity: 0; }
        }

        /* Gate Effect */
        .gate {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0) 70%);
            z-index: 999;
            opacity: 0;
            pointer-events: none;
            transform: scale(0.5);
            transition: all 1.5s ease;
        }

        .gate.active {
            opacity: 1;
            transform: scale(2);
        }

        /* Animations */
        @keyframes bounceIn {
            0% { opacity: 0; transform: scale(0.3); }
            50% { opacity: 1; transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .time { font-size: 3rem; }
            .date { font-size: 1.2rem; }
            h1 { font-size: 2.2rem; }
            .passcode-key { width: 50px; height: 50px; font-size: 1.5rem; }
            .tv-frame { width: 95%; max-width: 400px; padding: 15px;}
            .slider-container { height: 50vh; }
            .card-trigger { width: 300px; height: 220px; margin: 30px auto;} /* K√≠ch th∆∞·ªõc thi·ªáp tr√™n mobile */
            .card-instruction { font-size: 1rem; padding: 5px 10px; }
            .card-animation { width: 90%; height: 500px; }
            .card-quiz, .card-message-content { width: 95%; padding: 25px; }
            .card-message-content p { font-size: 1.3rem; }
            .card-message-content h2 { font-size: 2.2rem; }
            .card-message-content .signature { font-size: 1.2rem; margin-top: 30px;}
        }
    </style>
</head>
<body>
    <div class="lock-screen" id="lockScreen" role="dialog" aria-label="M√†n h√¨nh kh√≥a">
        <div class="time" id="time"></div>
        <div class="date" id="date"></div>
        <div class="passcode-container">
            <div class="passcode-error" id="passcodeError">Sai m·∫≠t kh·∫©u! Ch√¢u Th·ªã Kh·∫£ √Åi Vui l√≤ng th·ª≠ l·∫°i nh√≥eee.</div>
            <div class="passcode-input" aria-label="Nh·∫≠p m·∫≠t kh·∫©u">
                <div class="passcode-dot" aria-hidden="true"></div>
                <div class="passcode-dot" aria-hidden="true"></div>
                <div class="passcode-dot" aria-hidden="true"></div>
                <div class="passcode-dot" aria-hidden="true"></div>
            </div>
            <div class="passcode-keypad" role="grid">
                <div class="passcode-key" data-key="1" role="button" aria-label="S·ªë 1">1</div>
                <div class="passcode-key" data-key="2" role="button" aria-label="S·ªë 2">2</div>
                <div class="passcode-key" data-key="3" role="button" aria-label="S·ªë 3">3</div>
                <div class="passcode-key" data-key="4" role="button" aria-label="S·ªë 4">4</div>
                <div class="passcode-key" data-key="5" role="button" aria-label="S·ªë 5">5</div>
                <div class="passcode-key" data-key="6" role="button" aria-label="S·ªë 6">6</div>
                <div class="passcode-key" data-key="7" role="button" aria-label="S·ªë 7">7</div>
                <div class="passcode-key" data-key="8" role="button" aria-label="S·ªë 8">8</div>
                <div class="passcode-key" data-key="9" role="button" aria-label="S·ªë 9">9</div>
                <div class="passcode-key empty" aria-hidden="true"></div>
                <div class="passcode-key" data-key="0" role="button" aria-label="S·ªë 0">0</div>
                <div class="passcode-key delete" data-key="delete" role="button" aria-label="X√≥a">‚å´</div>
            </div>
        </div>
    </div>

    <div class="gate" id="gate"></div>

    <div class="birthday-container" id="birthdayContainer" role="main">
        <div class="birthday-content">
            <h1>Duy Khoa Ch√∫c M·ª´ng Kh·∫£ √Åi Sinh Nh·∫≠t vui v·∫ªe!</h1>

            <div class="tv-frame">
                <div class="tv-screen" id="mainGalleryDisplay" role="img" aria-label="·∫¢nh kho·∫£nh kh·∫Øc l·ªõn">
                    <img src="" alt="Kho·∫£nh kh·∫Øc ƒë√°ng y√™u" id="mainGalleryImage">
                    <div class="tv-static-effect"></div> <div class="tv-scanlines"></div> <div class="main-gallery-nav">
                        <span class="nav-btn" id="mainPrevBtn" role="button" aria-label="·∫¢nh tr∆∞·ªõc">‚ùÆ</span>
                        <span class="nav-btn" id="mainNextBtn" role="button" aria-label="·∫¢nh sau">‚ùØ</span>
                    </div>
                </div>
                <div class="tv-stand"></div>
                <div class="tv-button-panel">
                    <div class="tv-button"></div>
                    <div class="tv-power-button" id="tvPowerButton" role="button" aria-label="N√∫t ngu·ªìn TV"></div>
                    <div class="tv-speaker"></div>
                </div>
            </div>

            <div class="gallery-slider" id="gallerySlider" role="dialog" aria-label="B·ªô s∆∞u t·∫≠p ·∫£nh">
                <span class="close-gallery" role="button" aria-label="ƒê√≥ng b·ªô s∆∞u t·∫≠p">√ó</span>
                <div class="slider-container">
                    </div>
                <div class="thumbnail-nav" id="thumbnailNav" role="navigation"></div>
                <div class="slider-prev-btn" role="button" aria-label="·∫¢nh tr∆∞·ªõc">‚ùÆ</div>
                <div class="slider-next-btn" role="button" aria-label="·∫¢nh sau">‚ùØ</div>
            </div>

            <div class="card-trigger" id="cardTrigger" role="button" aria-label="M·ªü thi·ªáp ch√∫c m·ª´ng">
                <div class="card-envelope">
                    <div class="card-ribbon"></div>
                    <div class="card-instruction">Kh·∫£ √Åi Nh·∫•n v√†o ƒë√¢y ƒë·ªÉ m·ªü thi·ªáp nha!!</div>
                </div>
            </div>
        </div>

        <div class="card-container" id="cardContainer">
            <div class="card-quiz" id="cardQuiz">
                <h2> Kh·∫£ √Åi mong mu·ªën ƒëi·ªÅu g√¨ nh·∫•t trong cu·ªôc s·ªëng n</h2>
                <div class="quiz-options">
                    <div class="quiz-option" data-answer="Cu·ªôc s·ªëng h·∫°nh ph√∫c">Cu·ªôc s·ªëng h·∫°nh ph√∫c</div>
                    <div class="quiz-option" data-answer="B·∫£n th√¢n kh·ªèe m·∫°nh">B·∫£n th√¢n kh·ªèe m·∫°nh</div>
                    <div class="quiz-option" data-answer="Ba m·∫π kh·ªèe m·∫°nh">Ba m·∫π kh·ªèe m·∫°nh</div>
                    <div class="quiz-option" data-answer="S·ª©c kh·ªèe vi√™n m√£n">S·ª©c kh·ªèe vi√™n m√£n</div>
                    <div class="quiz-option" data-answer="Ti·ªÅn v√¥ nh∆∞ n∆∞·ªõc">Ti·ªÅn v√¥ nh∆∞ n∆∞·ªõc</div>
                    <div class="quiz-option" data-answer="M·ªçi chuy·ªán su√¥n s·∫ª">Khoa vui v·∫ª h·∫°nh ph√∫c tr√†n ƒë·∫ßy ni·ªÅm vui</div>
                    <div class="quiz-option" data-answer="T·∫•t c·∫£ nh·ªØng ƒëi·ªÅu tr√™n">T·∫•t c·∫£ nh·ªØng ƒëi·ªÅu tr√™n</div>
                </div>
                <div class="quiz-feedback" id="quizFeedback"></div>
            </div>
            <div class="card-animation" id="cardAnimation">
                <div class="card-paper" id="cardPaper">
                    <div class="happy-birthday">Happy Birthday!</div>
                    <div>Nh·∫•n ƒë·ªÉ xem l·ªùi ch√∫c!</div>
                </div>
            </div>
            <div class="card-message" id="cardMessage">
                <div class="card-message-content" id="cardMessageContent">
                    <span class="close-message" role="button" aria-label="ƒê√≥ng l·ªùi ch√∫c">√ó</span>
                    <h2>Ch√∫c M·ª´ng Sinh Nh·∫≠t!</h2>
                    <p>
                        Ch√∫c m·ª´ng sinh nh·∫≠t  Kh·∫£ √Åi nh√© Ch√∫c Kh·∫£ √Åi lu√¥n xinh ƒë·∫πp, tr·∫ª trung, th√†nh c√¥ng v√† g·∫∑t h√°i th·∫≠t nhi·ªÅu th√†nh qu·∫£ trong h·ªçc t·∫≠p, cu·ªôc s·ªëng. ü•≥<br>
                        Mong r·∫±ng ng√†y h√¥m nay Kh·∫£ √Åi s·∫Ω c√≥ m·ªôt ng√†y sinh nh·∫≠t th·∫≠t √Ω nghƒ©a b√™n gia ƒë√¨nh v√† nh·ªØng ng∆∞·ªùi th√¢n y√™u. Lu√¥n h·∫°nh ph√∫c v√† vui v·∫ª nh√©! ‚ù§Ô∏è
                    </p>
					<p class="signature">Ng√†y 30 th√°ng 12 nƒÉm 2025</p>
                    <p class="signature">Nguy·ªÖn Duy Khoa</p>
                </div>
            </div>
        </div>
    </div>

    <audio id="unlockSound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
    <audio id="balloonPopSound" src="https://assets.mixkit.co/sfx/preview/mixkit-balloon-pop-3067.mp3"></audio>
    <audio id="birthdayMusic" loop src="https://assets.mixkit.co/music/preview/mixkit-happy-birthday-to-you-653.mp3"></audio>
    <audio id="cardOpenSound" src="https://assets.mixkit.co/sfx/preview/mixkit-magic-sparkles-302.mp3"></audio>
    <audio id="tvTurnOnSound" src="https://assets.mixkit.co/sfx/preview/mixkit-tv-turn-on-1707.mp3"></audio>
    <audio id="tvTurnOffSound" src="https://assets.mixkit.co/sfx/preview/mixkit-tv-turn-off-1706.mp3"></audio>

    <script>
        // Utility Functions
        const $ = (selector) => document.querySelector(selector);
        const $$ = (selector) => document.querySelectorAll(selector);

        // Time Update
        function updateTime() {
            const now = new Date();
            const optionsTime = { hour: '2-digit', minute: '2-digit', hour12: false, timeZone: 'Asia/Ho_Chi_Minh' };
            const optionsDate = { weekday: 'long', day: 'numeric', month: 'long', timeZone: 'Asia/Ho_Chi_Minh' };
            $('#time').textContent = now.toLocaleTimeString('vi-VN', optionsTime);
            $('#date').textContent = new Intl.DateTimeFormat('vi-VN', optionsDate).format(now);
            setTimeout(updateTime, 1000);
        }
        updateTime();

        // Passcode Handling
        const correctPasscode = '3012';
        let enteredPasscode = '';
        let attemptCount = 0;
        const maxAttempts = 3;
        let isLocked = false;

        $$('.passcode-key:not(.empty)').forEach(key => {
            key.addEventListener('click', () => {
                if (isLocked) return;
                const value = key.dataset.key;
                if (value === 'delete') {
                    enteredPasscode = enteredPasscode.slice(0, -1);
                } else if (enteredPasscode.length < 4) {
                    enteredPasscode += value;
                }
                updatePasscodeDots();
                if (enteredPasscode.length === 4) {
                    if (enteredPasscode === correctPasscode) {
                        unlockDevice();
                    } else {
                        attemptCount++;
                        enteredPasscode = '';
                        updatePasscodeDots();
                        $('#passcodeError').classList.add('show');
                        $$('.passcode-dot').forEach(dot => {
                            dot.style.animation = 'shake 0.5s ease';
                            setTimeout(() => dot.style.animation = '', 500);
                        });
                        setTimeout(() => $('#passcodeError').classList.remove('show'), 2000);
                        if (attemptCount >= maxAttempts) {
                            isLocked = true;
                            $('#passcodeError').textContent = 'Qu√° nhi·ªÅu l·∫ßn th·ª≠! Vui l√≤ng ƒë·ª£i 30 gi√¢y.';
                            $('#passcodeError').classList.add('show');
                            setTimeout(() => {
                                isLocked = false;
                                attemptCount = 0;
                                $('#passcodeError').textContent = 'Sai m·∫≠t kh·∫©u! Vui l√≤ng th·ª≠ l·∫°i.';
                                $('#passcodeError').classList.remove('show');
                            }, 30000);
                        }
                    }
                }
            });
        });

        function updatePasscodeDots() {
            $$('.passcode-dot').forEach((dot, i) => {
                dot.classList.toggle('filled', i < enteredPasscode.length);
            });
        }

        function unlockDevice() {
            $('#unlockSound').play();
            $('#gate').classList.add('active');
            setTimeout(() => {
                $('#lockScreen').style.opacity = '0';
                $('#birthdayContainer').style.display = 'flex';
                createBalloons();
                createFallingStars();
                createHeartRain();
                startAutoSlide(); // Start auto slide for TV
                setTimeout(() => {
                    $('#lockScreen').style.display = 'none';
                    $('#gate').classList.remove('active');
                    // Add sparkle trail after unlock
                    document.addEventListener('mousemove', createSparkle);
                }, 1500);
            }, 1000);
        }

        // Balloon Animation
        const balloonColors = [
            ['#ff6b6b', '#ff99cc'], // Red-Pink
            ['#add8e6', '#87ceeb'], // Light Blue-Sky Blue
            ['#ffd700', '#ffa500'], // Gold-Orange
            ['#98fb98', '#3cb371'], // Pale Green-Medium Sea Green
            ['#dda0dd', '#ee82ee']  // Plum-Violet
        ];

        function createBalloons() {
            const container = $('#birthdayContainer');
            for (let i = 0; i < 15; i++) {
                const balloon = document.createElement('div');
                balloon.className = 'balloon';
                const colors = balloonColors[Math.floor(Math.random() * balloonColors.length)];
                balloon.style.setProperty('--balloon-color1', colors[0]);
                balloon.style.setProperty('--balloon-color2', colors[1]);
                balloon.style.left = `${Math.random() * 100}%`;
                balloon.style.animationDelay = `${Math.random() * 5}s`;
                balloon.addEventListener('click', () => {
                    $('#balloonPopSound').play();
                    balloon.style.display = 'none';
                    for (let j = 0; j < 5; j++) {
                        const heart = document.createElement('div');
                        heart.className = 'heart-particle';
                        heart.textContent = 'üíñ';
                        heart.style.left = `${balloon.getBoundingClientRect().left + balloon.offsetWidth / 2}px`;
                        heart.style.top = `${balloon.getBoundingClientRect().top + balloon.offsetHeight / 2}px`;
                        heart.style.setProperty('--tx', `${(Math.random() - 0.5) * 100}px`);
                        heart.style.setProperty('--ty', `${(Math.random() - 0.5) * 100}px`);
                        container.appendChild(heart);
                        setTimeout(() => heart.remove(), 1000);
                    }
                });
                container.appendChild(balloon);
            }
        }

        // Falling Stars Animation
        function createFallingStars() {
            const container = $('#birthdayContainer');
            for (let i = 0; i < 20; i++) { // S·ªë l∆∞·ª£ng sao r∆°i
                const star = document.createElement('div');
                star.className = 'falling-star';
                star.style.left = `${Math.random() * 100}vw`;
                star.style.animationDelay = `${Math.random() * 5}s`;
                star.style.setProperty('--duration', `${Math.random() * 3 + 2}s`); // Th·ªùi gian r∆°i t·ª´ 2-5s
                star.style.setProperty('--travelX', `${(Math.random() - 0.5) * 200}px`); // Ng·∫´u nhi√™n ƒë·ªô l·ªách ngang
                container.appendChild(star);
                setTimeout(() => star.remove(), (parseFloat(star.style.getPropertyValue('--duration')) * 1000) + 1000); // X√≥a sau khi h·∫øt animation
            }
        }

        // Heart Rain Animation
        function createHeartRain() {
            const container = $('#birthdayContainer');
            setInterval(() => {
                for (let i = 0; i < 5; i++) { // Th·∫£ 5 tr√°i tim m·ªói l·∫ßn
                    const heart = document.createElement('div');
                    heart.className = 'heart-rain';
                    heart.textContent = '‚ù§Ô∏è';
                    heart.style.left = `${Math.random() * 100}vw`;
                    heart.style.animationDelay = `${Math.random() * 0.5}s`;
                    heart.style.setProperty('--duration', `${Math.random() * 4 + 3}s`); // Th·ªùi gian r∆°i 3-7s
                    container.appendChild(heart);
                    setTimeout(() => heart.remove(), (parseFloat(heart.style.getPropertyValue('--duration')) * 1000) + 1000);
                }
            }, 2000); // M·ªói 2 gi√¢y th·∫£ m·ªôt ƒë·ª£t tim
        }

        // Sparkle Trail on Mouse Move
        function createSparkle(e) {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.style.left = `${e.clientX - 5}px`;
            sparkle.style.top = `${e.clientY - 5}px`;
            $('#birthdayContainer').appendChild(sparkle);
            setTimeout(() => sparkle.remove(), 800); // X√≥a sau 0.8s
        }

        // Gallery - Enhanced Slideshow
        const galleryImagesData = [
            { src: "a1.png", caption: "Kho·∫£nh kh·∫Øc ƒë√°ng y√™u 1" },
¬† ¬† ¬† ¬† ¬† ¬† { src: "a2.png", caption: "Kho·∫£nh kh·∫Øc ƒë√°ng y√™u 2" },
¬† ¬† ¬† ¬† ¬† ¬† { src: "a3.png", caption: "Kho·∫£nh kh·∫Øc ƒë√°ng y√™u 3" },
¬† ¬† ¬† ¬† ¬† ¬† { src: "a4.png", caption: "Kho·∫£nh kh·∫Øc ƒë√°ng y√™u 4" },
			{ src: "a5.png", caption: "Kho·∫£nh kh·∫Øc ƒë√°ng y√™u 1" },
¬† ¬† ¬† ¬† ¬† ¬† { src: "a6.png", caption: "Kho·∫£nh kh·∫Øc ƒë√°ng y√™u 2" },
¬† ¬† ¬† ¬† ¬† ¬† { src: "a7.png", caption: "Kho·∫£nh kh·∫Øc ƒë√°ng y√™u 3" },
¬† ¬† ¬† ¬† ¬† ¬† { src: "a8.png", caption: "Kho·∫£nh kh·∫Øc ƒë√°ng y√™u 4" },
			{ src: "a9.png", caption: "Kho·∫£nh kh·∫Øc ƒë√°ng y√™u 1" },
¬† ¬† ¬† ¬† ¬† ¬† { src: "a10.png", caption: "Kho·∫£nh kh·∫Øc ƒë√°ng y√™u 2" },
¬† ¬† ¬† ¬† ¬† ¬†
        ];

        let currentMainImageIndex = 0; // Index for the single main image
        let currentSliderIndex = 0;   // Index for the fullscreen slider
        let autoSlideInterval; // Variable to hold the interval for auto-sliding

        function updateMainGalleryDisplay() {
            const mainImg = $('#mainGalleryImage');
            // Ensure TV is on before updating image
            if (!$("#mainGalleryDisplay").classList.contains("off")) {
                mainImg.src = galleryImagesData[currentMainImageIndex].src;
                mainImg.alt = galleryImagesData[currentMainImageIndex].caption;
            }
        }

        function goToNextMainImage() {
            currentMainImageIndex = (currentMainImageIndex + 1) % galleryImagesData.length;
            updateMainGalleryDisplay();
            resetAutoSlide(); // Reset timer on manual interaction
        }

        function goToPrevMainImage() {
            currentMainImageIndex = (currentMainImageIndex - 1 + galleryImagesData.length) % galleryImagesData.length;
            updateMainGalleryDisplay();
            resetAutoSlide(); // Reset timer on manual interaction
        }

        function startAutoSlide() {
            // Clear any existing interval to prevent multiple intervals running
            clearInterval(autoSlideInterval);
            autoSlideInterval = setInterval(() => {
                // Only auto-slide if TV is on and fullscreen slider is not active
                if (isTvOn && !$('#gallerySlider').classList.contains('active')) {
                    goToNextMainImage();
                }
            }, 2000); // Change image every 2 seconds
        }

        function resetAutoSlide() {
            // Clear current interval and restart it
            clearInterval(autoSlideInterval);
            startAutoSlide();
        }

        function initGallery() {
            const sliderContainer = $('.slider-container');
            const thumbnailNav = $('#thumbnailNav');

            // Initialize main display
            updateMainGalleryDisplay();
            $('#mainPrevBtn').addEventListener('click', (e) => { e.stopPropagation(); goToPrevMainImage(); }); // Stop propagation to prevent TV power
            $('#mainNextBtn').addEventListener('click', (e) => { e.stopPropagation(); goToNextMainImage(); }); // Stop propagation to prevent TV power
            $('#mainGalleryDisplay').addEventListener('click', (e) => {
                if (!$("#mainGalleryDisplay").classList.contains("off")) {
                    openFullscreenSlider();
                }
                e.stopPropagation(); // Prevent TV power toggle
            });

            // Clear existing images and thumbnails from fullscreen slider
            sliderContainer.innerHTML = '';
            thumbnailNav.innerHTML = '';

            galleryImagesData.forEach((imageData, i) => {
                // Create slider image for fullscreen
                const sliderImg = document.createElement('img');
                sliderImg.className = 'slider-image';
                sliderImg.src = imageData.src;
                sliderImg.alt = imageData.caption;
                sliderImg.dataset.caption = imageData.caption;
                sliderContainer.appendChild(sliderImg);

                // Create thumbnail
                const thumb = document.createElement('img');
                thumb.className = 'thumbnail';
                thumb.src = imageData.src;
                thumb.alt = imageData.caption;
                thumb.dataset.index = i;
                thumb.addEventListener('click', () => goToSliderSlide(i));
                thumbnailNav.appendChild(thumb);
            });

            $('.close-gallery').addEventListener('click', closeGallery);
            $('.slider-prev-btn').addEventListener('click', () => {
                goToSliderSlide((currentSliderIndex - 1 + galleryImagesData.length) % galleryImagesData.length);
                resetAutoSlide(); // Reset timer on manual interaction
            });
            $('.slider-next-btn').addEventListener('click', () => {
                goToSliderSlide((currentSliderIndex + 1) % galleryImagesData.length);
                resetAutoSlide(); // Reset timer on manual interaction
            });
            $('.slider-container').addEventListener('click', (e) => {
                // Only advance slide if click is on the image, not the container background
                if (e.target.classList.contains('slider-image')) {
                    goToSliderSlide((currentSliderIndex + 1) % galleryImagesData.length);
                    resetAutoSlide(); // Reset timer on manual interaction
                }
                e.stopPropagation(); // Prevent closing gallery if clicking on image
            });
            $('#gallerySlider').addEventListener('click', (e) => { // Only close if clicking on the background
                if (e.target.id === 'gallerySlider') {
                    closeGallery();
                }
            });

            let touchStartX = 0, touchEndX = 0;
            $('.slider-container').addEventListener('touchstart', (e) => touchStartX = e.changedTouches[0].screenX);
            $('.slider-container').addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                if (touchEndX < touchStartX - 50) goToSliderSlide((currentSliderIndex + 1) % galleryImagesData.length);
                if (touchEndX > touchStartX + 50) goToSliderSlide((currentSliderIndex - 1 + galleryImagesData.length) % galleryImagesData.length);
                resetAutoSlide(); // Reset timer on manual interaction
            });
        }

        function openFullscreenSlider() {
            $('#gallerySlider').classList.add('active');
            document.body.style.overflow = 'hidden';
            // Start the fullscreen slider from the image currently displayed on the main page
            goToSliderSlide(currentMainImageIndex);
            clearInterval(autoSlideInterval); // Stop auto-slide when fullscreen slider is open
        }

        function goToSliderSlide(index) {
            const sliderImages = $$('.slider-image');
            const thumbnails = $$('.thumbnail');

            sliderImages.forEach(img => img.classList.remove('active'));
            sliderImages[index].classList.add('active');

            thumbnails.forEach(thumb => thumb.classList.remove('active'));
            thumbnails[index].classList.add('active');

            currentSliderIndex = index;

            // Scroll thumbnail into view
            thumbnails[index].scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
        }

        function closeGallery() {
            $('#gallerySlider').classList.remove('active');
            document.body.style.overflow = 'auto';
            startAutoSlide(); // Restart auto-slide when fullscreen slider is closed
        }

        initGallery(); // Call initGallery once DOM is ready

        // TV Power Button functionality
        const tvScreen = $('#mainGalleryDisplay');
        const tvPowerButton = $('#tvPowerButton');
        let isTvOn = true;

        tvPowerButton.addEventListener('click', () => {
            if (isTvOn) {
                // Turn off TV
                tvScreen.classList.add('off');
                $('#tvTurnOffSound').play();
                clearInterval(autoSlideInterval); // Stop auto-slide when TV is off
            } else {
                // Turn on TV
                tvScreen.classList.remove('off');
                $('#tvTurnOnSound').play();
                updateMainGalleryDisplay(); // Show current image after turning on
                startAutoSlide(); // Restart auto-slide when TV is on
            }
            isTvOn = !isTvOn; // Toggle state
        });

        // Birthday Card Functionality

        // Event listener for opening the card container
        $('#cardTrigger').addEventListener('click', () => {
            $('#cardContainer').classList.add('active');
            $('#cardQuiz').style.display = 'block'; // Show the quiz first
            $('#cardAnimation').classList.remove('active'); // Hide card animation initially
            $('#cardMessage').classList.remove('active'); // Ensure message is hidden
            $('#cardMessageContent').classList.remove('open'); // Ensure message content is hidden
            $('#quizFeedback').classList.remove('show'); // Hide any previous quiz feedback
            $('#cardPaper').classList.remove('revealed'); // Reset paper for new reveal
            $('#birthdayMusic').pause(); // T·∫°m d·ª´ng nh·∫°c n·ªÅn khi m·ªü quiz/thi·ªáp
            $('#birthdayMusic').currentTime = 0; // Reset nh·∫°c v·ªÅ ƒë·∫ßu
            clearInterval(autoSlideInterval); // Stop auto-slide when card is opened
        });

        // Quiz logic
        $$('.quiz-option').forEach(option => {
            option.addEventListener('click', () => {
                const answer = option.dataset.answer;
                const quizFeedback = $('#quizFeedback');

                // ƒê√°p √°n ƒë√∫ng gi·ªù ƒë√¢y l√† "T·∫•t c·∫£ nh·ªØng ƒëi·ªÅu tr√™n"
                const correctAnswer = "T·∫•t c·∫£ nh·ªØng ƒëi·ªÅu tr√™n";

                if (answer === correctAnswer) { // Correct answer logic
                    $('#unlockSound').play(); // Play a success sound
                    quizFeedback.textContent = 'Ch√≠nh x√°c! Chu·∫©n b·ªã nh·∫≠n qu√† n√†o!';
                    quizFeedback.style.color = '#4CAF50'; // Green color for success
                    quizFeedback.classList.add('show');

                    setTimeout(() => {
                        $('#cardQuiz').style.display = 'none'; // Hide the quiz
                        $('#cardAnimation').classList.add('active'); // Show the card animation
                        $('#cardPaper').classList.add('revealed'); // Reveal the paper immediately for letter style
                        $('#cardOpenSound').play(); // Play card open sound
                    }, 2000); // Give user time to read feedback
                } else { // Incorrect answer logic
                    quizFeedback.textContent = 'Sai r·ªìi! Th·ª≠ l·∫°i nh√©!';
                    quizFeedback.style.color = '#ff4757'; // Red color for error
                    quizFeedback.classList.add('show');
                    // Shake the quiz container for immediate feedback
                    $('#cardQuiz').style.animation = 'shake 0.5s ease';
                    setTimeout(() => $('#cardQuiz').style.animation = '', 500);
                }
            });
        });

        // Event listener to open the full message from the card paper
        $('#cardPaper').addEventListener('click', () => {
            $('#cardAnimation').classList.remove('active'); // Hide the card animation
            $('#cardMessage').classList.add('active'); // Show the full message container
            $('#birthdayMusic').play(); // Ph√°t nh·∫°c Happy Birthday khi m·ªü th∆∞
            // Trigger message content animation after a short delay
            setTimeout(() => {
                $('#cardMessageContent').classList.add('open');
            }, 100);
            createConfetti(); // Create confetti effect
        });

        // Event listener to close the full message
        $('.close-message').addEventListener('click', () => {
            $('#cardMessageContent').classList.remove('open');
            setTimeout(() => {
                $('#cardMessage').classList.remove('active');
                $('#cardContainer').classList.remove('active'); // Close the entire card container
                $('#birthdayMusic').pause(); // T·∫°m d·ª´ng nh·∫°c khi ƒë√≥ng thi·ªáp
                $('#birthdayMusic').currentTime = 0; // Reset nh·∫°c v·ªÅ ƒë·∫ßu
                startAutoSlide(); // Restart auto-slide when card is closed
            }, 500); // Match with CSS transition
        });

        // Confetti animation
        function createConfetti() {
            const messageContent = $('#cardMessageContent');
            const colors = ['#ff4757', '#ff6b6b', '#ff99cc', '#ffd700', '#fff0f5']; // More vibrant colors
            // Clear existing confetti if any
            messageContent.querySelectorAll('.confetti').forEach(c => c.remove());

            for (let i = 0; i < 50; i++) { // Generate 50 confetti particles
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                // Random position within the message content
                confetti.style.left = `${Math.random() * 100}%`;
                confetti.style.top = `${Math.random() * 100}%`;
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = `${Math.random() * 1}s`; // Stagger animation
                messageContent.appendChild(confetti);
                setTimeout(() => confetti.remove(), 2000); // Remove after animation
            }
        }
    </script>
</body>
</html>
